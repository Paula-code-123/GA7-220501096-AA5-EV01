<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Carrito de Compras - Sara Store</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <style>
      body {
        font-family: "Poppins", sans-serif;
        background-color: #f1f3f5;
        padding: 40px 0;
      }
      .cart-container {
        max-width: 900px;
        margin: auto;
        background-color: #ffffff;
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      }
      .cart-header {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 30px;
      }
      .cart-header img {
        height: 50px;
      }
      .cart-header h2 {
        font-weight: bold;
        margin: 0;
      }
      .cart-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        justify-content: space-between;
      }
      .cart-item {
        background-color: #f8f9fa;
        border-radius: 10px;
        padding: 15px;
        width: 48%;
        display: flex;
        gap: 15px;
        align-items: flex-start;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
        position: relative;
      }
      .cart-item img {
        height: 100px;
        border-radius: 8px;
      }
      .cart-description {
        flex-grow: 1;
      }
      .cart-price {
        font-weight: bold;
        color: #2ecc71;
        margin-top: 5px;
      }
      .total-section {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 30px;
        font-size: 1.2rem;
        font-weight: bold;
      }
      .btn-comprar {
        background: linear-gradient(45deg, #45a049, #45a049);
        border: none;
        color: white;
        padding: 12px 30px;
        border-radius: 8px;
        font-size: 1rem;
        transition: background 0.3s ease, transform 0.2s ease;
      }
      .btn-comprar:hover {
        background: linear-gradient(45deg, #388e3c, #2e7d32);
        transform: scale(1.03);
      }
      @media (max-width: 768px) {
        .cart-item {
          width: 100%;
        }
        .total-section {
          flex-direction: column;
          gap: 10px;
          align-items: flex-start;
        }
      }
    </style>
  </head>
  <body>
    <div style="background-color: #212529; color: white; padding: 10px 20px">
      <h2 class="m-0">Sara Store</h2>
    </div>
    <div class="cart-container">
      <div class="cart-header">
        <img src="logo.webp" alt="Sara Store" />
        <h2>Carrito de Compras</h2>
      </div>

      <div class="cart-grid" id="cart-items"></div>

      <div class="total-section">
        <span id="total">TOTAL: $0</span>
        <button class="btn-comprar" id="btn-comprar">Realizar compra</button>
      </div>
    </div>
    <script>
      function mostrarCarrito() {
        const carrito = JSON.parse(localStorage.getItem("carrito")) || [];
        const contenedor = document.getElementById("cart-items");
        contenedor.innerHTML = "";

        if (carrito.length === 0) {
          contenedor.innerHTML = "<p>Tu carrito está vacío.</p>";
          document.getElementById("total").innerText = "TOTAL: $0";
          return;
        }

        carrito.forEach((producto, idx) => {
          contenedor.innerHTML += `
    <div class="cart-item" data-idx="${idx}" data-price="${producto.precio}">
      <img src="${producto.imagen}" alt="${producto.nombre}">
      <div class="cart-description">
        <strong>${producto.nombre}</strong><br>
        <div class="talla-cantidad">
          Talla:
          <select class="form-select talla-select" style="width:70px;display:inline-block;">
            <option value="XS" ${
              producto.talla === "XS" ? "selected" : ""
            }>XS</option>
            <option value="S" ${
              producto.talla === "S" ? "selected" : ""
            }>S</option>
            <option value="M" ${
              producto.talla === "M" ? "selected" : ""
            }>M</option>
            <option value="L" ${
              producto.talla === "L" ? "selected" : ""
            }>L</option>
            <option value="XL" ${
              producto.talla === "XL" ? "selected" : ""
            }>XL</option>
          </select>
          Cantidad:
          <input type="number" class="form-control cantidad-input" value="${
            producto.cantidad || 1
          }" min="1" style="width:70px;display:inline-block;">
        </div>
        <div class="cart-price">$${parseInt(producto.precio).toLocaleString(
          "es-CO"
        )}</div>
      </div>
      <i class="fas fa-trash delete-icon eliminar-icono" style="cursor:pointer"></i>
    </div>
  `;
        });

        actualizarTotal();
        agregarEventos();
      }

      function actualizarTotal() {
        const items = document.querySelectorAll(".cart-item");
        let total = 0;
        items.forEach((item) => {
          const cantidad =
            parseInt(item.querySelector(".cantidad-input").value) || 1;
          const precioUnitario = parseInt(item.getAttribute("data-price"));
          total += precioUnitario * cantidad;
          item.querySelector(".cart-price").innerText = `$${(
            precioUnitario * cantidad
          ).toLocaleString("es-CO")}`;
        });
        document.getElementById(
          "total"
        ).innerText = `TOTAL: $${total.toLocaleString("es-CO")}`;
        guardarCantidades();
      }

      function agregarEventos() {
        // Evento para eliminar producto
        document.querySelectorAll(".eliminar-icono").forEach((icon) => {
          icon.addEventListener("click", function () {
            const idx = this.closest(".cart-item").getAttribute("data-idx");
            let carrito = JSON.parse(localStorage.getItem("carrito")) || [];
            carrito.splice(idx, 1);
            localStorage.setItem("carrito", JSON.stringify(carrito));
            mostrarCarrito();
          });
        });

        document.querySelectorAll(".cantidad-input").forEach((input) => {
          input.addEventListener("input", actualizarTotal);
        });
      }

      function guardarCantidades() {
        const items = document.querySelectorAll(".cart-item");
        let carrito = JSON.parse(localStorage.getItem("carrito")) || [];
        items.forEach((item) => {
          const idx = item.getAttribute("data-idx");
          const cantidad =
            parseInt(item.querySelector(".cantidad-input").value) || 1;
          carrito[idx].cantidad = cantidad;
        });
        localStorage.setItem("carrito", JSON.stringify(carrito));
      }

      document
        .getElementById("btn-comprar")
        .addEventListener("click", function () {
          window.location.href = "realizar-compra.html";
        });

      document.addEventListener("DOMContentLoaded", mostrarCarrito);
    </script>
  </body>
</html>
